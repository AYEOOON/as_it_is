import 'package:flutter/material.dart';

class AllergyProvider with ChangeNotifier {
  final List<String> _allergyItems = [
    '난류',
    '대두',
    '우유',
    '곡류',
    '갑각류',
    '견과류',
    '생선류',
    '연체류',
    '아황산류',
    '육류',
  ];

  // 알러지 항목별 포함된 재료
  final Map<String, List<String>> _categorizedIngredients = {
    '난류': [
      '계란', '달걀', '메추리알', '오리알', '삶은 계란',
      '스크램블 에그', '계란말이', '계란찜', '계란 프라이',
      '삶은 오리알', '훈제 오리알', '오믈렛', '달걀국', '달걀 샌드위치'
    ],
    '대두': [
      '콩', '대두', '검은콩', '완두콩', '녹두',
      '두부', '순두부', '콩나물', '된장', '청국장',
      '간장', '쌈장', '두유', '두부조림', '콩비지',
      '유부', '두부튀김', '두부 샐러드', '검은콩 강정'
    ],
    '우유': [
      '우유', '저지방 우유', '초콜릿 우유', '딸기 우유',
      '요구르트', '플레인 요구르트', '딸기 요구르트', '치즈',
      '모짜렐라 치즈', '체다 치즈', '크림 치즈', '리코타 치즈',
      '파마산 치즈', '버터', '무염버터', '생크림', '휘핑크림',
      '요거트 스무디', '버터크림', '치즈케이크'
    ],
    '곡류': [
      '쌀', '현미', '찹쌀', '흑미', '오곡',
      '밀', '밀가루', '통밀', '보리', '율무',
      '귀리', '퀴노아', '옥수수', '팝콘', '콘플레이크',
      '옥수수 전분', '메밀', '메밀국수', '누룽지', '오트밀', '죽'
    ],
    '갑각류': [
      '새우', '랍스터', '게', '킹크랩', '꽃게',
      '홍합', '전복', '소라', '조개', '가리비',
      '꼬막', '바지락', '굴', '물회', '홍합탕'
    ],
    '견과류': [
      '아몬드', '볶은 아몬드', '아몬드 슬라이스', '호두',
      '캐슈넛', '땅콩', '볶은 땅콩', '땅콩버터', '피스타치오',
      '헤이즐넛', '브라질너트', '마카다미아', '밤', '잣',
      '호두강정', '아몬드 초콜릿', '캐슈넛 볶음', '땅콩 초코바'
    ],
    '생선류': [
      '고등어', '구운 고등어', '훈제 고등어', '참치',
      '참치캔', '연어', '훈제 연어', '생태', '동태',
      '꽁치', '갈치', '조기', '광어', '우럭',
      '붕어', '잉어', '민어', '멸치', '청어', '삼치', '대구', '방어'
    ],
    '연체류': [
      '오징어', '오징어 젓', '건조 오징어', '문어',
      '삶은 문어', '문어숙회', '조개', '바지락', '가리비',
      '꼬막', '홍합', '해삼', '멍게', '전복',
      '키조개', '골뱅이', '소라', '꼬막무침', '조개탕', '가리비구이'
    ],
    '아황산류': [
      '건포도', '말린 자두', '건블루베리', '건망고',
      '건크랜베리', '와인', '레드 와인', '화이트 와인',
      '식초', '사과 식초', '발사믹 식초', '레몬즙',
      '황도 통조림', '설탕 시럽', '매실주', '건자두', '건파인애플'
    ],
    '육류': [
      '소고기', '한우', '쇠고기 다짐육', '양지머리', '돼지고기',
      '삼겹살', '목살', '닭고기', '닭가슴살', '닭다리',
      '양고기', '염소고기', '베이컨', '햄', '소시지',
      '스테이크', '갈비', '불고기', '족발', '닭갈비', '떡갈비'
    ],
  };

  late List<bool> _isSelected;

  AllergyProvider() {
    _isSelected = List.generate(_allergyItems.length, (index) => false);
  }

  List<String> get allergyItems => _allergyItems;
  List<bool> get isSelected => _isSelected;

  int get selectedAllergyCount =>
      _isSelected.where((selected) => selected).length;

  void updateSelection(int index, bool value) {
    _isSelected[index] = value;
    notifyListeners();
  }

  // 선택된 알러지 항목에 해당하는 재료를 반환
  List<String> getExcludedIngredients() {
    List<String> excludedIngredients = [];

    for (int i = 0; i < _allergyItems.length; i++) {
      if (_isSelected[i]) {
        excludedIngredients.addAll(_categorizedIngredients[_allergyItems[i]] ?? []);
      }
    }

    return excludedIngredients;
  }
}
